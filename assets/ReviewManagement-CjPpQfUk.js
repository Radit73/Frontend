import{r as a,g as h,j as e,a as b,i as g,b as y,v as E}from"./index-_RlfeBLV.js";import{S as x}from"./SidebarAdmin-Ai76bB7Y.js";import{S}from"./SectionTitle-P0FvPO9X.js";import{g as u}from"./theme-eDaETbEk.js";const P=()=>{const[s,j]=a.useState(h()),[v,f]=a.useState([]),[p,c]=a.useState(!0),[l,d]=a.useState(""),[i,w]=a.useState(()=>u()),m=async()=>{try{c(!0);const n=(await b(g())).map(async o=>(await y(o.id)).map(R=>({...R,game_title:o.title}))),r=await Promise.all(n);f(r.flat())}catch(t){d(t.message)}finally{c(!1)}};a.useEffect(()=>{const t=()=>j(h());return window.addEventListener("auth-changed",t),()=>window.removeEventListener("auth-changed",t)},[]),a.useEffect(()=>{const t=()=>w(u());return window.addEventListener("theme-changed",t),()=>window.removeEventListener("theme-changed",t)},[]),a.useEffect(()=>{const t=document.body;return t.classList.add("theme-page-admin"),i==="light"?t.classList.add("theme-light"):t.classList.remove("theme-light"),()=>{t.classList.remove("theme-page-admin"),t.classList.remove("theme-light")}},[i]),a.useEffect(()=>{var t,n;(((t=s==null?void 0:s.user)==null?void 0:t.role)==="ADMIN"||((n=s==null?void 0:s.user)==null?void 0:n.role)==="SUPER_ADMIN")&&m()},[s]);const N=async t=>{if(window.confirm("Hapus review ini?"))try{await E(t,g()),m()}catch(n){d(n.message)}};return!s||s.user.role!=="ADMIN"&&s.user.role!=="SUPER_ADMIN"?e.jsxs("div",{className:`admin-layout ${i==="light"?"theme-light":""}`,children:[e.jsx(x,{active:"Kelola Review"}),e.jsx("main",{className:"admin-content",children:e.jsx("p",{className:"error-text",children:"Akses ditolak."})})]}):e.jsxs("div",{className:`admin-layout ${i==="light"?"theme-light":""}`,children:[e.jsx(x,{active:"Kelola Review"}),e.jsxs("main",{className:"admin-content",children:[e.jsx("div",{className:"admin-content__header",children:e.jsxs("div",{children:[e.jsx("h1",{children:"Kelola Review Pemain"}),e.jsx("p",{className:"muted-text",children:"Pantau konten komunitas dengan cepat."})]})}),e.jsxs("div",{className:"card",children:[e.jsx(S,{title:"Daftar Review"}),l&&e.jsx("p",{className:"error-text",children:l}),p?e.jsx("p",{children:"Sedang memuat review..."}):e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"admin-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Nama Game"}),e.jsx("th",{children:"User"}),e.jsx("th",{children:"Rating"}),e.jsx("th",{children:"Potongan Komentar"}),e.jsx("th",{children:"Tanggal"}),e.jsx("th",{children:"Aksi"})]})}),e.jsx("tbody",{children:v.map(t=>{var r;const n=`${((r=t.comment)==null?void 0:r.slice(0,60))||""}${t.comment&&t.comment.length>60?"...":""}`;return e.jsxs("tr",{children:[e.jsx("td",{children:t.game_title}),e.jsx("td",{children:t.user_name}),e.jsx("td",{children:t.rating}),e.jsx("td",{children:n}),e.jsx("td",{children:new Date(t.created_at).toLocaleDateString("id-ID")}),e.jsx("td",{className:"table-actions",children:e.jsx("button",{type:"button",className:"btn-danger btn-small",onClick:()=>N(t.id),children:"Hapus"})})]},t.id)})})]})})]})]})]})};export{P as default};
